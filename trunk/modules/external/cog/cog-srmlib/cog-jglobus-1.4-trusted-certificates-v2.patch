diff -ru /tmp/cog-jglobus-1.4/src/org/globus/gsi/gssapi/GlobusGSSContextImpl.java cog-jglobus-1.4/src/org/globus/gsi/gssapi/GlobusGSSContextImpl.java
--- /tmp/cog-jglobus-1.4/src/org/globus/gsi/gssapi/GlobusGSSContextImpl.java	2006-08-16 21:08:06.000000000 +0200
+++ cog-jglobus-1.4/src/org/globus/gsi/gssapi/GlobusGSSContextImpl.java	2007-08-29 13:43:17.394447000 +0200
@@ -752,13 +752,7 @@
                                          "noCaCerts");
         }
         try {
-            if (this.tc instanceof PureTLSTrustedCertificates) {
-                this.context.setRootList( 
-                    ((PureTLSTrustedCertificates)this.tc).getX509CertList()
-                );
-            } else {
-                this.context.setTrustedCertificates(this.tc.getCertificates());
-            }
+            this.context.setRootList(this.tc.getX509CertList());
         } catch (GeneralSecurityException e) {
             throw new GlobusGSSException(GSSException.FAILURE, e);
         }
diff -ru /tmp/cog-jglobus-1.4/src/org/globus/gsi/TrustedCertificates.java cog-jglobus-1.4/src/org/globus/gsi/TrustedCertificates.java
--- /tmp/cog-jglobus-1.4/src/org/globus/gsi/TrustedCertificates.java	2006-01-20 21:21:25.000000000 +0100
+++ cog-jglobus-1.4/src/org/globus/gsi/TrustedCertificates.java	2007-08-30 09:54:18.820136449 +0200
@@ -15,17 +15,20 @@
  */
 package org.globus.gsi;
 
+import java.security.GeneralSecurityException;
 import java.security.cert.X509Certificate;
 import java.util.Map;
 import java.util.HashMap;
 import java.util.StringTokenizer;
 import java.util.Collection;
 import java.util.Iterator;
+import java.util.Vector;
 import java.io.File;
 import java.io.FilenameFilter;
 
 import org.globus.common.CoGProperties;
 import org.globus.util.TimestampEntry;
+import org.globus.gsi.ptls.PureTLSUtil;
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
@@ -44,6 +47,7 @@
     private Map certSubjectDNMap;
     private Map certFileMap;
     private boolean changed;
+    private Vector certList = null;
     
     protected TrustedCertificates() {}
     
@@ -55,6 +59,19 @@
 	}
     }
 
+    /**
+     * Returns the trusted certificates as a Vector of X509Cert objects.
+     */
+    public synchronized Vector getX509CertList() 
+        throws GeneralSecurityException  
+    {
+	if (certList == null) {
+            certList = 
+                PureTLSUtil.certificateChainToVector(getCertificates());
+	}
+	return certList;
+    }
+
     public X509Certificate[] getCertificates() {
 	if (this.certSubjectDNMap == null) {
 	    return null;
@@ -178,6 +195,7 @@
 
 	this.certFileMap = newCertFileMap;
 	this.certSubjectDNMap = newCertSubjectDNMap;
+        certList = null;
     }
 
     /**
@@ -192,6 +210,7 @@
 			  Map newCertFileMap,
 			  Map newCertSubjectDNMap) {
 	X509Certificate cert = null;
+        certList = null;
 	
 	if (this.certFileMap == null) {
 	    this.certFileMap = new HashMap();
Only in cog-jglobus-1.4/src/org/globus/gsi: TrustedCertificates.java~
