<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 1.1.2  (Linux)">
	<META NAME="CREATED" CONTENT="20041109;10003000">
	<META NAME="CHANGED" CONTENT="20041129;12593700">
	<STYLE>
	<!--
		@page { size: 8.5in 11in; margin-left: 1.25in; margin-right: 1.25in; margin-top: 1in; margin-bottom: 1in }
		P { margin-bottom: 0.08in }
		H2 { margin-bottom: 0.04in; color: #000000; text-align: center; widows: 2; orphans: 2 }
		H2.western { font-size: 12pt; so-language: en-GB }
		H2.cjk { font-family: "Times New Roman", serif; font-size: 12pt }
		H2.ctl { font-family: "Arial", sans-serif; font-size: 14pt; so-language: ar-SA; font-style: italic }
		H3 { margin-top: 0.08in; margin-bottom: 0.04in; color: #000000; widows: 2; orphans: 2 }
		H3.western { font-size: 12pt; so-language: en-GB; font-style: italic; font-weight: medium }
		H3.cjk { font-family: "Times New Roman", serif; font-size: 12pt; font-style: italic; font-weight: medium }
		H3.ctl { font-family: "Arial", sans-serif; font-size: 13pt; so-language: ar-SA }
		P.sdendnote-western { margin-left: 0.25in; text-indent: -0.25in; margin-bottom: 0in; color: #000000; font-family: "Times New Roman", serif; font-size: 10pt; so-language: en-GB; text-align: justify; widows: 2; orphans: 2 }
		P.sdendnote-cjk { margin-left: 0.25in; text-indent: -0.25in; margin-bottom: 0in; color: #000000; font-family: "Times New Roman", serif; font-size: 10pt; text-align: justify; widows: 2; orphans: 2 }
		P.sdendnote-ctl { margin-left: 0.25in; text-indent: -0.25in; margin-bottom: 0in; color: #000000; font-family: "Times New Roman", serif; font-size: 10pt; so-language: ar-SA; text-align: justify; widows: 2; orphans: 2 }
		A.sdendnotesym-western { font-family: "Times New Roman", serif; font-size: 10pt }
		A.sdendnotesym-cjk { font-size: 10pt }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<H2 LANG="en-GB" CLASS="western">FERMILAB UNIX File System SRM</H2>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=2>Fermilab
provides a reference implementation of the SRM-Storage  interface to
a Unix File System. You can read more about SRM interface at
[1,2,3,4].  Fermilab's srm implementation conforms to the SRM version
1.1 specification. Fermilab srm implementation is developed as a part
of  DESY – Fermilab dCache project [5].  Its source is available
for download from [4]. It provides the following features: fully
blown implementation of srm v1.1 specification, support for srm
“get”, “put” and “copy” functions,  gsiftp as a transfer
protocol for “get “ and “put” operations,  built-in gsiftp
client for SRM to SRM or MSS transfers. This reference implementation
provides highly configurable transfer scheduling mechanism, which
utilizes queues and limits the number  of simultaneous transfers
performed by either client or server itself. It retries each
operation upon failure and uses database to store its state to
provide a high level of robustness and reliability.</FONT></FONT></FONT></P>
<H3 LANG="en-GB" CLASS="western" STYLE="text-indent: 0.13in"><FONT FACE="Times New Roman">Installation
of File System SRM.</FONT></H3>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=2><FONT FACE="Times New Roman">The
latest version of this product can be downloaded from
</FONT><A HREF="http://www-isd.fnal.gov/srm/unix-fs-srm/Unix-FS-SRM.tgz"></A><A HREF="http://www-isd.fnal.gov/srm/unix-fs-srm/Unix-FS-SRM.tgz"><FONT SIZE=2><FONT FACE="Times New Roman"><FONT COLOR="#000000">http://www-isd.fnal.gov/srm/unix-fs-srm/Unix-FS-SRM.tgz</FONT></FONT></FONT></A><A HREF="http://www-isd.fnal.gov/srm/unix-fs-srm/Unix-FS-SRM.tgz"></A><FONT FACE="Times New Roman">.
The prerequisite to the srm installation if the presence  of the host
certificates and the functional gsiftp server installation from
globus toolkit on the node.  SRM product uses of the postgress
database, which should be installed and running on one of the network
reachable server, with username and password available. SRM server is
a java program, which will need the java compiler for building and
java virtual machine for execution. Please refer to [6], [7] and [8]
for installation and configuration instructions of gridftp server,
postgres database server and java development kit (jdk).</FONT></FONT></FONT></FONT></P>
<H3 LANG="en-GB" CLASS="western" STYLE="text-indent: 0.13in"><FONT FACE="Times New Roman">Building.</FONT></H3>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>To
build SRM , extract the content of the archive to an instalation
directory and make instalation directory you current directory. Than
execute the following two commands:</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<BR>
</P>
<OL>
	<OL TYPE=i START=400>
		<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
		<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>1.
		StandaloneFileSystemSRM/diskCacheV111/srm</FONT></FONT></FONT></P>
		<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
		<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>2.
		./makeSimpleDiskStorageElement.sh</FONT></FONT></FONT></P>
	</OL>
</OL>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>Note:
The script makeSimpleDiskStorageElement.sh relies on the presence of
Sun Microsystem's java 1.4 development kit. The system path should
include the kit's bin directory containing javac compiler.</FONT></FONT></FONT></P>
<H3 LANG="en-GB" CLASS="western" STYLE="text-indent: 0.13in"><FONT FACE="Times New Roman">Configuration.</FONT></H3>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>Once
the srm is built, you would need to edit
StandaloneFileSystemSRM/diskCacheV111/srm/simpleDiskStorageElement/.srmconfig/config.xml,
and put in the correct values for sql database user, password, url
and jdbc driver (Postress jdbc driver is included in pgjdbc2.jar ),
and the locations of the host x509 private key and certificate.</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>You
will also need to edit the script
StandaloneFileSystemSRM/diskCacheV111/srm/simpleDiskStorageElement/run
and put in the correct values for gridftp server host and port
(variables GRIDFTP_HOST and GRIDFTP_PORT), name of the SRM server
(variable NAME), which needs to be unique for each SRM server using
the same database,  in case of multiple SRMs, and location of the log
file (variable LOG).</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>In
order to add users to the system, you will have to modify two files:</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>1.
/etc/grid-security/grid-mapfile to add the mapping from the user
certificate   to the local account</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>2.
StandaloneFileSystemSRM/diskCacheV111/srm/simpleDiskStorageElement/.srmconfig/dcache.kpwd</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000">  <FONT FACE="Times New Roman"><FONT SIZE=2>to
add the mapping and the login entries for the user. There is a
description of the structure of this file in the prefix of
dcache.kpwd file itself.</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<BR>
</P>
<H3 LANG="en-GB" CLASS="western" STYLE="text-indent: 0.13in"><FONT FACE="Times New Roman">Running
the server.</FONT></H3>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>Once
it is done, you can start the server by running the following
commands as a root:</FONT></FONT></FONT></P>
<OL>
	<LI><P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
	<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>cd
	StandaloneFileSystemSRM/diskCacheV111/srm/simpleDiskStorageElement;
	.</FONT></FONT></FONT></P>
	<LI><P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
	<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>./run</FONT></FONT></FONT></P>
</OL>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>Once
this is done, you will see an srm admin shell prompt on the screen,
type help to see the list of available commands. This will allow you
to monitor the state of the system and to cancel the requests.</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>Note:
SRM will create all the database tables automatically.</FONT></FONT></FONT></P>
<H3 LANG="en-GB" CLASS="western" STYLE="text-indent: 0.13in"><FONT FACE="Times New Roman">Obtaining
and running the srm client.</FONT></H3>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>Once
the system is running, you can use srmcp client to access the system.
You can download the client sources from 
<A HREF="http://www-isd.fnal.gov/srm/unix-fs-srm/srmclient.tgz"><FONT SIZE=2><FONT FACE="Times New Roman"><FONT COLOR="#000000">http://www-isd.fnal.gov/srm/unix-fs-srm/srmclient.tgz</FONT></FONT></FONT></A><FONT FACE="Times New Roman">.
</FONT></FONT></FONT></FONT>
</P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>To
build the client do the following:</FONT></FONT></FONT></P>
<OL>
	<LI><P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
	<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>Untar
	the archive, this will create the directory srmclient.</FONT></FONT></FONT></P>
	<LI><P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
	<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>Assign
	the path to the srm server installation directory to an exported
	enviroment variable SRM_SERVER:</FONT></FONT></FONT></P>
	<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
	<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>export
	SRM_SERVER= &lt;path&gt;</FONT></FONT></FONT></P>
	<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
	<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>execute
	the following  commands:</FONT></FONT></FONT></P>
	<LI><P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
	<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>cd
	srmclient</FONT></FONT></FONT></P>
	<LI><P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
	<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>cp
	-r $SRM_SERVER/diskCacheV111/srm/classes/globus lib/globus</FONT></FONT></FONT></P>
	<LI><P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
	<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>mkdir
	 lib/dcache</FONT></FONT></FONT></P>
	<LI><P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
	<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>cp
	$SRM_SERVER/diskCacheV111/srm/classes/dcache-srm.jar  lib/dcache</FONT></FONT></FONT></P>
	<LI><P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
	<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>make</FONT></FONT></FONT></P>
</OL>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>Read
README text file to learn about srmcp usage</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="text-indent: 0.13in; margin-bottom: 0in; widows: 2; orphans: 2">
<BR>
</P>
<H2 LANG="en-GB" CLASS="western">References 
</H2>
<P LANG="en-GB" CLASS="sdendnote-western"><FONT FACE="Times New Roman, serif"><FONT SIZE=2><FONT FACE="Times New Roman">[1]
</FONT><FONT FACE="Times New Roman, serif"><FONT SIZE=2><FONT FACE="Times New Roman"><FONT COLOR="#000000"><SPAN LANG="en-GB">Arie</SPAN>
<SPAN LANG="en-GB">Shoshany</SPAN> at al, </FONT></FONT></FONT></FONT></FONT></FONT>SRM
Joint Design v.1.0, http://sdm.lbl.gov/srm-wg/doc/srm.v1.0.pdf</P>
<P LANG="en-GB" CLASS="sdendnote-western">[2] <FONT FACE="Times New Roman, serif"><FONT SIZE=2><FONT FACE="Times New Roman"><FONT COLOR="#000000">Arie
Shoshany at al, </FONT></FONT></FONT></FONT>SRM Interface 
Specification v.2.1, 
http://sdm.lbl.gov/srm-wg/doc/SRM.spec.v2.1.final.pdf</P>
<P LANG="en-GB" CLASS="sdendnote-western"><FONT FACE="Times New Roman, serif"><FONT SIZE=2><FONT FACE="Times New Roman">[3]</FONT></FONT></FONT><FONT FACE="Times New Roman">	The
Storage Resource Manager Collaboration Pages,
<FONT COLOR="#000000">http://sdm.lbl.gov/srm-wg/</FONT></FONT></P>
<P LANG="en-GB" CLASS="sdendnote-western"><FONT FACE="Times New Roman">[4]
	Fermilab SRM Project ,<FONT COLOR="#000000">
http://www-isd.fnal.gov/srm</FONT></FONT></P>
<P LANG="en-GB" CLASS="sdendnote-western"><FONT COLOR="#000000"><FONT FACE="Times New Roman">[5]
<SPAN LANG="en-GB">DCache</SPAN>, Disk Cache Mass Storage System,
http://www.dcache.org/</FONT></FONT></P>
<P LANG="en-GB" CLASS="sdendnote-western"><FONT COLOR="#000000"><FONT FACE="Times New Roman">[6]
 http://www.globus.org</FONT></FONT></P>
<P LANG="en-GB" CLASS="sdendnote-western"><FONT COLOR="#000000"><FONT FACE="Times New Roman">[7]
http://www.postgresql.org/</FONT></FONT></P>
<P LANG="en-GB" CLASS="sdendnote-western"><FONT COLOR="#000000"><FONT FACE="Times New Roman">[8]
http://java.sun.com</FONT></FONT></P>
</BODY>
</HTML>