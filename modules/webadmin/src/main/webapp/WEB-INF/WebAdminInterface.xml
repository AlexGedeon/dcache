<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:jee="http://www.springframework.org/schema/jee"
        xsi:schemaLocation="http://www.springframework.org/schema/jee
                            http://www.springframework.org/schema/jee/spring-jee-3.1.xsd
                            http://www.springframework.org/schema/beans
                            http://www.springframework.org/schema/beans/spring-beans-2.5.xsd">

    <jee:jndi-lookup id="serviceCellEndpoint" jndi-name="java:comp/env/serviceCellEndpoint"/>
    <jee:jndi-lookup id="adminGid" jndi-name="java:comp/env/adminGid"/>
    <jee:jndi-lookup id="gPlazmaName" jndi-name="java:comp/env/gPlazmaName"/>
    <jee:jndi-lookup id="dCacheInstanceName" jndi-name="java:comp/env/dCacheInstanceName"/>
    <jee:jndi-lookup id="loginBrokerName" jndi-name="java:comp/env/loginBrokerName"/>
    <jee:jndi-lookup id="pnfsManagerName" jndi-name="java:comp/env/pnfsManagerName"/>
    <jee:jndi-lookup id="poolManagerName" jndi-name="java:comp/env/poolManagerName"/>
    <jee:jndi-lookup id="collectorTimeout" jndi-name="java:comp/env/collectorTimeout"/>
    <jee:jndi-lookup id="transfersCollectorUpdate" jndi-name="java:comp/env/transfersCollectorUpdate"/>
    <jee:jndi-lookup id="billingToDb" jndi-name="java:comp/env/billingToDb"/>
    <jee:jndi-lookup id="generatePlots" jndi-name="java:comp/env/generatePlots"/>
    <jee:jndi-lookup id="plotsDir" jndi-name="java:comp/env/plotsDir"/>
    <jee:jndi-lookup id="exportExt" jndi-name="java:comp/env/exportExt"/>
    <jee:jndi-lookup id="alarmXMLPath" jndi-name="java:comp/env/alarmXMLPath"/>
    <jee:jndi-lookup id="alarmCleanerEnabled" jndi-name="java:comp/env/alarmCleanerEnabled"/>
    <jee:jndi-lookup id="alarmCleanerSleepInterval" jndi-name="java:comp/env/alarmCleanerSleepInterval"/>
    <jee:jndi-lookup id="alarmCleanerDeleteThreshold" jndi-name="java:comp/env/alarmCleanerDeleteThreshold"/>
    <jee:jndi-lookup id="alarmDAOProperties" jndi-name="java:comp/env/alarmDAOProperties"/>

    <bean id="PoolCellStub" class="org.dcache.cells.CellStub">
        <property name="cellEndpoint" ref="serviceCellEndpoint"/>
        <property name="destination" value=""/>
        <property name="timeout" value="4000"/>
    </bean>

    <bean id="PoolMonitorCollectorCellStub" class="org.dcache.cells.CellStub">
        <property name="cellEndpoint" ref="serviceCellEndpoint"/>
        <property name="destination" ref="poolManagerName"/>
        <property name="timeout" value="4000"/>
    </bean>

    <bean id="ActiveTransfersCollectorCellStub" class="org.dcache.cells.CellStub">
        <property name="cellEndpoint" ref="serviceCellEndpoint"/>
        <property name="destination" value=""/>
        <property name="timeout" ref="collectorTimeout"/>
    </bean>

    <bean id="CellStatusCollectorCellStub" class="org.dcache.cells.CellStub">
       <property name="cellEndpoint" ref="serviceCellEndpoint"/>
       <property name="destination" value=""/>
       <property name="timeout" ref="collectorTimeout"/>
    </bean>

    <bean id="SpaceTokenCollectorCellStub" class="org.dcache.cells.CellStub">
        <property name="cellEndpoint" ref="serviceCellEndpoint"/>
        <property name="destination" value="SrmSpaceManager"/>
        <property name="timeout" ref="collectorTimeout"/>
    </bean>

    <bean id="RestoreHandlerCollectorCellStub" class="org.dcache.cells.CellStub">
        <property name="cellEndpoint" ref="serviceCellEndpoint"/>
        <property name="destination" ref="poolManagerName"/>
        <property name="timeout" ref="collectorTimeout"/>
    </bean>

    <bean id="PageInfoCache" class="org.dcache.webadmin.model.dataaccess.communication.impl.PageInfoCache" init-method="init" destroy-method="stop">
        <constructor-arg>
            <list>
                <bean id="ActiveTransfersCollector" class="org.dcache.webadmin.model.dataaccess.communication.collectors.ActiveTransfersCollector">
                    <property name="cellStub" ref="ActiveTransfersCollectorCellStub"/>
                    <property name="name" value="Active Transfers Collector"/>
                    <property name="update" ref="transfersCollectorUpdate"/>
                    <property name="loginBrokerName" ref="loginBrokerName"/>
                </bean>
                <bean id="CellStatusCollector" class="org.dcache.webadmin.model.dataaccess.communication.collectors.CellStatusCollector">
                    <property name="cellStub" ref="CellStatusCollectorCellStub"/>
                    <property name="name" value="Cellstatus Collector"/>
                    <property name="loginBrokerName" ref="loginBrokerName"/>
                    <property name="pnfsManagerName" ref="pnfsManagerName"/>
                    <property name="poolManagerName" ref="poolManagerName"/>
                    <property name="gPlazmaName" ref="gPlazmaName"/>
                </bean>
                <bean id="PoolMonitorCollector" class="org.dcache.webadmin.model.dataaccess.communication.collectors.PoolMonitorCollector">
                    <property name="cellStub" ref="PoolMonitorCollectorCellStub"/>
                    <property name="name" value="PoolMonitor Collector"/>
                </bean>
                <bean id="SpaceTokenCollector" class="org.dcache.webadmin.model.dataaccess.communication.collectors.SpaceTokenCollector">
                    <property name="cellStub" ref="SpaceTokenCollectorCellStub"/>
                    <property name="name" value="SpaceToken Collector"/>
                </bean>
                <bean id="RestoreHandlerCollector" class="org.dcache.webadmin.model.dataaccess.communication.collectors.RestoreHandlerCollector">
                    <property name="cellStub" ref="RestoreHandlerCollectorCellStub"/>
                    <property name="name" value="RestoreHandler Collector"/>
                    <property name="poolManagerName" ref="poolManagerName"/>
                </bean>
            </list>
        </constructor-arg>
    </bean>

    <bean id="CommandSenderFactory" class="org.dcache.webadmin.model.dataaccess.communication.impl.CellCommandSenderFactory">
        <property name="poolCellStub" ref="PoolCellStub"/>
    </bean>

    <bean id="DAOFactory" class="org.dcache.webadmin.model.dataaccess.impl.DAOFactoryImpl">
        <property name="defaultCommandSenderFactory" ref="CommandSenderFactory"/>
        <property name="pageCache" ref="PageInfoCache"/>
        <property name="alarmXMLPath" ref="alarmXMLPath"/>
        <property name="alarmCleanerEnabled" ref="alarmCleanerEnabled"/>
        <property name="alarmCleanerSleepInterval" ref="alarmCleanerSleepInterval"/>
        <property name="alarmCleanerDeleteThreshold" ref="alarmCleanerDeleteThreshold"/>
        <property name="alarmDAOProperties" ref="alarmDAOProperties"/>
    </bean>

    <bean id="PoolSpaceService" class="org.dcache.webadmin.controller.impl.StandardPoolSpaceService">
        <constructor-arg>
            <ref bean="DAOFactory"/>
        </constructor-arg>
    </bean>

    <bean id="PoolQueuesService" class="org.dcache.webadmin.controller.impl.StandardPoolQueuesService">
        <constructor-arg>
            <ref bean="DAOFactory"/>
        </constructor-arg>
    </bean>

    <bean id="PoolGroupService" class="org.dcache.webadmin.controller.impl.StandardPoolGroupService">
        <constructor-arg>
            <ref bean="DAOFactory"/>
        </constructor-arg>
    </bean>

    <bean id="InfoService" class="org.dcache.webadmin.controller.impl.StandardInfoService">
        <constructor-arg>
            <ref bean="DAOFactory"/>
        </constructor-arg>
    </bean>

    <bean id="CellsService" class="org.dcache.webadmin.controller.impl.StandardCellsService">
        <constructor-arg>
            <ref bean="DAOFactory"/>
        </constructor-arg>
    </bean>

    <bean id="PoolAdminService" class="org.dcache.webadmin.controller.impl.StandardPoolAdminService">
        <constructor-arg>
            <ref bean="DAOFactory"/>
        </constructor-arg>
    </bean>

    <bean id="CellAdminService" class="org.dcache.webadmin.controller.impl.StandardCellAdminService">
        <constructor-arg>
            <ref bean="DAOFactory"/>
        </constructor-arg>
    </bean>

    <bean id="LinkGroupsService" class="org.dcache.webadmin.controller.impl.StandardLinkGroupsService">
        <constructor-arg>
            <ref bean="DAOFactory"/>
        </constructor-arg>
    </bean>

    <bean id="ActiveTransfersService" class="org.dcache.webadmin.controller.impl.StandardActiveTransfersService">
        <constructor-arg>
            <ref bean="DAOFactory"/>
        </constructor-arg>
    </bean>

    <bean id="TapeTransfersService" class="org.dcache.webadmin.controller.impl.StandardTapeTransfersService">
        <constructor-arg>
            <ref bean="DAOFactory"/>
        </constructor-arg>
    </bean>

    <bean id="PoolSelectionSetupService" class="org.dcache.webadmin.controller.impl.StandardPoolSelectionSetupService">
        <constructor-arg>
            <ref bean="DAOFactory"/>
        </constructor-arg>
    </bean>

    <bean id="AlarmDisplayService" class="org.dcache.webadmin.controller.impl.StandardAlarmDisplayService">
        <constructor-arg>
            <ref bean="DAOFactory"/>
        </constructor-arg>
    </bean>

    <bean id="WebAdminInterface" class="org.dcache.webadmin.view.WebAdminInterface">
        <property name="poolSpaceService" ref="PoolSpaceService"/>
        <property name="poolQueuesService" ref="PoolQueuesService"/>
        <property name="poolGroupService" ref="PoolGroupService"/>
        <property name="infoService" ref="InfoService"/>
        <property name="cellsService" ref="CellsService"/>
        <property name="poolAdminService" ref="PoolAdminService"/>
        <property name="cellAdminService" ref="CellAdminService"/>
        <property name="linkGroupsService" ref="LinkGroupsService"/>
        <property name="activeTransfersService" ref="ActiveTransfersService"/>
        <property name="poolSelectionSetupService" ref="PoolSelectionSetupService"/>
        <property name="tapeTransfersService" ref="TapeTransfersService"/>
        <property name="alarmDisplayService" ref="AlarmDisplayService"/>
        <property name="cellEndpoint" ref="serviceCellEndpoint"/>
        <property name="adminGid" ref="adminGid"/>
        <property name="dcacheName" ref="dCacheInstanceName"/>
        <property name="authDestination" ref="gPlazmaName"/>
        <property name="billingToDb" ref="billingToDb"/>
        <property name="generatePlots" ref="generatePlots"/>
        <property name="plotsDir" ref="plotsDir"/>
        <property name="exportExt" ref="exportExt"/>
    </bean>
</beans>
