<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-2.5.xsd">

    <bean id="InfoCellStub"
        class="org.dcache.webadmin.model.dataaccess.impl.ServletContextCellStub">
        <constructor-arg type="java.lang.String" value="info"/>
        <property name="timeout" value="4000"/>
    </bean>

    <bean id="PoolCellStub"
        class="org.dcache.webadmin.model.dataaccess.impl.ServletContextCellStub">
        <constructor-arg type="java.lang.String" value=""/>
        <property name="timeout" value="4000"/>
    </bean>

    <bean id="GplazmaCellStub"
        class="org.dcache.webadmin.model.dataaccess.impl.ServletContextCellStub">
        <constructor-arg type="java.lang.String" value="gPlazma"/>
        <property name="timeout" value="180000"/>
    </bean>

    <bean id="XMLDataGatherer"
        class="org.dcache.webadmin.model.dataaccess.impl.CellXMLDataGatherer">
        <property name="infoCellStub" ref="InfoCellStub"/>
    </bean>

    <bean id="CommandSenderFactory"
        class="org.dcache.webadmin.model.dataaccess.communication.impl.CellCommandSenderFactory">
        <property name="poolCellStub" ref="PoolCellStub"/>
    </bean>

    <bean id="DAOFactory" class="org.dcache.webadmin.model.dataaccess.impl.DAOFactoryImpl">
        <property name="defaultXMLDataGatherer" ref="XMLDataGatherer"/>
        <property name="defaultCommandSenderFactory" ref="CommandSenderFactory"/>
    </bean>

    <bean id="PoolBeanService" class="org.dcache.webadmin.controller.impl.PoolBeanServiceImpl">
        <constructor-arg>
            <ref bean="DAOFactory"/>
        </constructor-arg>
    </bean>

    <bean id="LoginStrategy" class="org.dcache.auth.UnionLoginStrategy">
        <description>Processes login requests</description>
        <property name="loginStrategies">
            <list>
                <bean class="org.dcache.auth.KauthFileLoginStrategy">
                    <constructor-arg>
                        <bean class="org.springframework.beans.factory.config.PropertyPathFactoryBean">
                            <property name="targetBeanName" value="InfoCellStub"/>
                            <property name="propertyPath" value="kpwdFile"/>
                        </bean>
                    </constructor-arg>
                </bean>
                <bean class="org.dcache.auth.GplazmaLoginStrategy">
                    <constructor-arg>
                        <bean class="org.dcache.auth.AuthzQueryHelper">
                            <constructor-arg ref="GplazmaCellStub"/>
                        </bean>
                    </constructor-arg>
                </bean>
            </list>
        </property>
        <property name="anonymousAccess" value="NONE"/>
    </bean>

    <bean id="LogInService" class="org.dcache.webadmin.controller.impl.GuestLogInDecorator">
        <constructor-arg>
            <bean class="org.dcache.webadmin.controller.impl.LoginStrategyLogInService">
                <property name="loginStrategy" ref="LoginStrategy"/>
                <property name="adminGid">
                    <bean class="org.springframework.beans.factory.config.PropertyPathFactoryBean">
                        <property name="targetBeanName" value="InfoCellStub"/>
                        <property name="propertyPath" value="adminGid"/>
                    </bean>
                </property>
            </bean>
        </constructor-arg>
    </bean>

    <bean id="WebAdminInterface" class="org.dcache.webadmin.view.WebAdminInterface">
        <property name="poolBeanService" ref="PoolBeanService"/>
        <property name="logInService" ref="LogInService"/>
        <property name="httpPort">
            <bean class="org.springframework.beans.factory.config.PropertyPathFactoryBean">
                <property name="targetBeanName" value="InfoCellStub"/>
                <property name="propertyPath" value="httpPort"/>
            </bean>
        </property>
        <property name="httpsPort">
            <bean class="org.springframework.beans.factory.config.PropertyPathFactoryBean">
                <property name="targetBeanName" value="InfoCellStub"/>
                <property name="propertyPath" value="httpsPort"/>
            </bean>
        </property>
        <property name="dcacheName">
            <bean class="org.springframework.beans.factory.config.PropertyPathFactoryBean">
                <property name="targetBeanName" value="InfoCellStub"/>
                <property name="propertyPath" value="dcacheName"/>
            </bean>
        </property>
    </bean>
</beans>
