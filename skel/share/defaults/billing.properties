#  -----------------------------------------------------------------------
#     Default values for billing
#  -----------------------------------------------------------------------
#
#   This Java properties file contains default values for billing
#   configuration parameters. All values can be redefined in
#   etc/dcache.conf. Do not modify any values here as your changes
#   will be lost when you next upgrade.

#  ---- Cell name of billing service
#
billing/cell.name=billing

#  ---- Directory for billing logs
#
#   The directory within which the billing logs are to be written.
#
billingLogsDir=${dcache.paths.billing}

#  ---- Disable billing to plain text file
#
#   Controls whether dCache activity is logged as plain text files.  Valid
#   values are 'true' and 'false'.  If the property is set to 'false' then
#   activity is logged in text files.  If set to 'true' then there is no
#   logging to text files.
#
billingDisableTxt=false

#  -----------------------------------------------------------------------
#     Format of billing entries for the output in the plain text biling file
#  -----------------------------------------------------------------------

#  ---- Available parameters for all messages:
#
#   $date$ - date of transfer
#   $pnfsid$ - pnfsid of a file
#   $filesize$ - file size
#   $cellName$ - the name of the cell, message comming from
#   $cellType$ - type of the cell, message comming from
#   $messageType$ - type of the incomming message. It could be a MoverInforMessage or PnfsFileInfoMessage etc.
#   $path$ - path of the requested file
#   $storageInfo$ - storage info of the requested file containing storage class and storage hsm
#   $storageInfo.storageClass$ - storage class from the storage info
#   $storageInfo.hsm$ - storage hsm from the storage info
#   $rc$ - result code
#   $message$ - result message (is empty in case of success and has a text message in case of an error

#  ---- Available parameters for transfer messages:
#
#   $dataTransferred$ - transferred data
#   $connectionTime$ - connection time
#   $fileCreated$ - info about if the file is newly created
#   $protocolInfo$ - protocolInfo of the transfer
#   $initiator$ - cell name initiated the transfer
#   $subject$ - security-related information of identities of a single person, the record will contain the principals (uid, gid, FQAN, DN, Username, Kerberos, Client-IP), Public Credentials (public keys, usernames) or Private Credentials (passwords, private keys)
#   $subject.dn$ - DN (distinguished name) of the Subject
#   $subject.primaryUid$ - primary uid (user id) of the Subject
#   $subject.uid$ - uid (user ids) of the Subject
#   $subject.uids$ - uids (user ids) of the Subject
#   $subject.primaryGid$ - primary gid (group id) of the Subject
#   $subject.gids$ - gids (group ids) of the Subject
#   $subject.primaryFqan$ - primary FQAN (Fully Qualified Attribute Names used by VOMS) of the Subject
#   $subject.fqans$ - FQANS (Fully Qualified Attribute Names used by VOMS) of the Subject
#   $subject.userName$ - user name of the logged Subject
#   $subject.loginName$ - login name of the Subject
#
#   Examples:
#   by specifying $date; format=yyyy.MM.dd HH:mm:ss:SSS$ the date and time will be formatted respecting the given pattern "yyyy.MM.dd HH:mm:ss:SSS".
#   Any other date pattern can be choosen according to the java API SimpleDateFormat class.
#   The default pattern is for the parameter $date$ is "MM.dd HH:mm:ss".

poolTransferMessage=$date$ [$cellType$:$cellName$:$messageType$] [$pnfsid$,$filesize$] [$path$] $storageInfo.storageClass$@$storageInfo.hsm$ $dataTransferred$ $connectionTime$ $fileCreated$ {$protocolInfo$} [$initiator$] {$rc$:$message$}

#  ---- Formatting the remove file message:
#

poolRemoveMessage=$date$ [$cellType$:$cellName$:$messageType$] [$pnfsid$,$filesize$] [$path$] $storageInfo.storageClass$@$storageInfo.hsm$ {$rc$:$message$}

#  ---- Available parameters only for door messages:
#
#
#   $transactionTime$ - transaction time
#   $timeQueued$ - time queued
#   $subject$ - security-related information of identities of a single person

doorMessage=$date$ [$cellType$:$cellName$:$messageType$] [$subject$] [$pnfsid$,$filesize$] [$path$] $storageInfo.storageClass$@$storageInfo.hsm$ $transactionTime$ $timeQueued$ {$rc$:$message$}

#  ---- Available parameters for storage (store/restore) messages:
#
#   $transferTime$ - transfer time
#   $timeQueued$ - time queued

storageMessage=$date$ [$cellType$:$cellName$:$messageType$] [$pnfsid$,$filesize$] [$path$] $storageInfo.storageClass$@$storageInfo.hsm$ $transferTime$ $timeQueued$ {$rc$:$message$}

#  -----------------------------------------------------------------------
#     Store billing data in database
##  -----------------------------------------------------------------------

#   This property describes whether the billing information should be
#   written to a PostgreSQL database.  Valid values are 'no' and 'yes'.
#
#   When this property is set to 'yes' then the database must be created
#   but dCache can manage the creation and evolution of tables.
#
billingToDb=no

# ---- Use DAO access layer to persistence
#
billingInfoAccess=org.dcache.services.billing.db.impl.datanucleus.DataNucleusBillingInfo

# ---- If this is set, it overrides the jar-resident configuration resource
#      for the DAO implementation, if any
billingInfoAccessPropertiesFile=

# ---- Commit optimizations: in-memory caching thresholds
#
billingMaxInsertsBeforeCommit=10000
billingMaxTimeBeforeCommitInSecs=5

# ---- liquibase changelog
billingChangelog=org/dcache/services/billing/db/sql/billing.changelog-master.xml

# ---- liquibase update
updateBillingDb=true

# ---- pool manager
poolManager=PoolManager

# ---- communcation timeout
poolConnectTimeout=3600000

# ---- RDBMS/JDBC Driver
#
billingDbDriver=org.postgresql.Driver

# ---- RDBMS/JDBC URL
#
billingDbUrl=jdbc:postgresql://${billingDbHost}/${billingDbName}

# ---- RDBMS/JDBC Database host name
#
billingDbHost=localhost

# ---- RDBMS/JDBC Database user name
#
billingDbUser=srmdcache

# ---- RDBMS/JDBC Database user password
#
billingDbPass=srmdcache

#  The following enables using pgfile, which is disabled by default
#  billingDbPgPassFileName=/root/.pgpass
#
billingDbPgPassFileName=

# ---- Database name
#
billingDbName=billing

#  ---- If this is set, it overrides the jar-resident configuration resource
#       for ITimeFramePlot, if any
billingPlotPropertiesFile=

#
# Database related settings reserved for internal use.
#
billing/db.name=${billingDbName}
billing/db.user=${billingDbUser}
billing/db.host=${billingDbHost}
billing/db.password=${billingDbPass}
billing/db.driver=${billingDbDriver}
billing/db.url=${billingDbUrl}
billing/db.schema.auto=false
